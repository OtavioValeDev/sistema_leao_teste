<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Pedidos - Cliente</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
    <style>
      /* Inlined CSS from style.css */
      @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap');
      :root {
          --bg:#fff6e9;
          --card:#ffffff;
          --muted:#6b7280;
          --accent:#ff6b00;
          --accent-2:#ffd166;
          --success:#27ae60;
          --danger:#e74c3c;
          --radius:14px;
          --shadow: 0 10px 30px rgba(15,15,15,0.08);
      }

        body {
          font-family: 'Poppins', sans-serif;
          background: linear-gradient(180deg,#fff 0%, #fff6e9 100%);
      }

      /* Accessibility focus */
      :focus {
          outline: 3px solid rgba(255,107,0,0.18);
          outline-offset: 4px;
      }
      /* Product card hover effect */
      .product-card {
          transition: transform 0.3s ease, box-shadow 0.3s ease;
      }

      .product-card:hover {
          transform: translateY(-5px);
          box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
      }

      /* Custom scrollbar */
      ::-webkit-scrollbar {
          width: 8px;
      }

      ::-webkit-scrollbar-track {
          background: #f1f1f1;
          border-radius: 10px;
      }

      ::-webkit-scrollbar-thumb {
          background: #888;
          border-radius: 10px;
      }

      ::-webkit-scrollbar-thumb:hover {
          background: #555;
      }

      /* Animation for cart items */
      @keyframes fadeIn {
          from { opacity: 0; transform: translateY(10px); }
          to { opacity: 1; transform: translateY(0); }
      }

      .cart-item {
          animation: fadeIn 0.3s ease forwards;
      }

      /* Preferential service styles */
      .preferential-service-section {
          background: linear-gradient(45deg, #f39c12, #e67e22);
            padding: 20px;
          margin: 20px 0;
          border-radius: 10px;
            text-align: center;
          box-shadow: 0 4px 15px rgba(243, 156, 18, 0.3);
      }
      .preferential-service-section h3 {
          color: white;
            margin-bottom: 10px;
            font-size: 1.5em;
      }
      .preferential-service-section p {
          color: rgba(255,255,255,0.9);
            margin-bottom: 15px;
        }
      .preferential-button {
          background: white;
          color: #e67e22;
            border: none;
          padding: 12px 25px;
          border-radius: 8px;
            cursor: pointer;
          font-size: 1.1em;
            font-weight: bold;
          transition: all 0.3s;
          box-shadow: 0 3px 10px rgba(0,0,0,0.2);
      }
      .preferential-button:hover {
          transform: translateY(-2px);
          box-shadow: 0 5px 15px rgba(0,0,0,0.3);
      }

      /* Product details expansion */
      .product-details {
          display: none;
          margin-top: 15px;
            padding: 15px;
          background: #f8f9fa;
            border-radius: 8px;
          border: 1px solid #dee2e6;
      }
      .product-details.show {
          display: block;
          animation: slideDown 0.3s ease;
      }
      .expand-button {
          background: #3498db;
          color: white;
          border: none;
          padding: 8px 16px;
          border-radius: 6px;
          cursor: pointer;
            font-size: 0.9em;
          margin-top: 10px;
          transition: background 0.3s;
      }
      .expand-button:hover {
          background: #2980b9;
      }
      .expand-button.expanded {
            background: #e74c3c;
        }
      .expand-button.expanded:hover {
            background: #c0392b;
        }

      /* Receipt modal styles */
        .receipt-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            animation: fadeIn 0.3s ease;
        }
        .receipt-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 30px;
            border-radius: 15px;
            max-width: 400px;
            width: 90%;
            text-align: center;
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
        }

      /* Preferential receipt modal */
      .preferential-modal {
          display: none;
          position: fixed;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          background: rgba(0, 0, 0, 0.8);
          z-index: 1000;
          animation: fadeIn 0.3s ease;
      }
      .preferential-content {
            position: absolute;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          background: white;
          padding: 30px;
          border-radius: 15px;
          max-width: 500px;
          width: 90%;
            text-align: center;
          box-shadow: 0 20px 40px rgba(0,0,0,0.3);
        }

        /* Animations */
      @keyframes slideDown {
          from {
              opacity: 0;
              max-height: 0;
              padding-top: 0;
              padding-bottom: 0;
          }
          to {
              opacity: 1;
              max-height: 500px;
              padding-top: 15px;
              padding-bottom: 15px;
          }
        }
    </style>
</head>
<body class="bg-gray-100">
    <main class="min-h-screen bg-gradient-to-br from-orange-50 to-blue-50 flex items-center justify-center p-4">
        <div class="w-full max-w-7xl space-y-8">
            <!-- Header -->
            <div class="text-center">
                <div class="flex justify-center items-center mb-4">
                    <span class="text-4xl">üçΩÔ∏è</span>
                </div>
                <h1 class="text-3xl font-bold text-gray-800 mb-2">√Årea do Cliente</h1>
                <p class="text-gray-600">Escolha seus produtos e fa√ßa seu pedido</p>
            </div>

            <!-- Content -->
            <div class="bg-white rounded-2xl shadow-xl p-8">
                <div class="flex flex-col lg:flex-row gap-8">
                    <!-- Products Section -->
                    <section class="lg:w-3/4">
                        <div class="controls mb-6">
                            <div class="search flex items-center gap-2 p-4 rounded-xl bg-orange-50 border-2 border-orange-100">
                                <i data-feather="search" class="text-orange-600"></i>
                                <input id="searchInput" class="w-full bg-transparent outline-none text-gray-700" placeholder="Pesquisar (ex: hamb√∫rguer, batata)" aria-label="Pesquisar produtos">
                            </div>
                            <div class="categories flex gap-2 mt-4 overflow-auto py-2">
                                <!-- Categories will be populated by JS -->
                            </div>
                        </div>
                        <h2 class="text-2xl font-bold mb-6 text-gray-800">üçΩÔ∏è Escolha seus Produtos</h2>
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="products-grid">
                            <!-- Products will be loaded here -->
                            <div class="text-center py-12 text-gray-500">
                                <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-orange-600 mx-auto mb-4"></div>
                                Carregando produtos...
                            </div>
                        </div>
                    </section>

                    <!-- Cart Section -->
                    <section class="lg:w-1/4">
                        <div class="bg-gray-50 rounded-xl p-6">
                            <div class="flex items-center justify-between mb-6">
                                <h2 class="text-xl font-bold text-gray-800">üõí Seu Pedido</h2>
                                <i data-feather="shopping-cart" class="text-gray-600"></i>
                            </div>
                            <div id="cart-items" class="mb-4">
                                <!-- Cart items will appear here -->
                                <p class="text-gray-500 italic" id="empty-cart-message">Seu carrinho est√° vazio</p>
                            </div>
                            <div class="border-t border-gray-200 pt-4">
                                <div class="flex justify-between items-center mb-2">
                                    <span class="font-medium">Subtotal:</span>
                                    <span class="font-bold" id="subtotal">R$0,00</span>
                                </div>
                                <div class="flex justify-between items-center mb-4">
                                    <span class="font-medium">Tax (10%):</span>
                                    <span class="font-bold" id="tax">R$0,00</span>
                                </div>
                                <div class="flex justify-between items-center text-lg font-bold mb-6">
                                    <span>Total:</span>
                                    <span id="total">R$0,00</span>
                                </div>
                                <button id="checkout-btn" class="w-full bg-green-600 hover:bg-green-700 text-white py-3 px-4 rounded-lg font-medium transition duration-200 disabled:opacity-50 disabled:cursor-not-allowed" disabled>
                                    Finalizar Pedido
                                </button>
                            </div>
                        </div>

                        <!-- Preferential Service Section -->
                        <div class="mt-6 bg-gradient-to-r from-yellow-400 to-orange-500 text-white p-4 rounded-xl text-center">
                            <h3 class="font-bold mb-2">‚≠ê Atendimento Preferencial</h3>
                            <p class="text-sm mb-3 opacity-90">Precisa de atendimento r√°pido?</p>
                            <button id="preferentialButton" class="bg-white text-orange-600 px-4 py-2 rounded-lg font-medium hover:bg-gray-100 transition duration-200">
                                üöÄ Solicitar
                            </button>
                        </div>
                    </section>
                </div>
            </div>
        </div>
    </main>

    <custom-footer></custom-footer>

    <!-- Modal -->
    <div id="order-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden z-50">
        <div class="bg-white rounded-lg p-6 w-full max-w-md">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-bold text-gray-800">Confirma√ß√£o do Pedido</h3>
                <button onclick="closeModal()" class="text-gray-500 hover:text-gray-700">
                    <i data-feather="x"></i>
                </button>
            </div>
            <p class="mb-4 text-gray-600">Obrigado pelo seu pedido! Sua comida estar√° pronta em breve.</p>
            <div id="order-summary" class="mb-6">
                <!-- Order summary will appear here -->
            </div>
            <button onclick="processOrder()" class="w-full bg-green-600 hover:bg-green-700 text-white py-2 px-4 rounded-lg font-medium transition duration-200 mr-2">
                Confirmar Pedido
            </button>
            <button onclick="closeModal()" class="w-full bg-gray-500 hover:bg-gray-600 text-white py-2 px-4 rounded-lg font-medium transition duration-200">
                Cancelar
            </button>
        </div>
    </div>

    <!-- Receipt Modal -->
    <div id="receiptModal" class="receipt-modal">
        <div class="receipt-content">
            <span class="close-button" onclick="closeReceiptModal()">&times;</span>

            <div class="receipt-header">
                <h2>üçî RESTAURANTE</h2>
                <p>Pedido Realizado com Sucesso!</p>
            </div>

            <div class="receipt-number" id="receiptNumber">
                #0000
            </div>

            <div class="receipt-details" id="receiptDetails">
                <!-- Receipt details will be populated here -->
            </div>

            <div style="margin: 20px 0; padding: 15px; background: #fff3cd; border-radius: 8px; border: 1px solid #f0c674;">
                <strong>üì¢ Importante:</strong><br>
                Anote seu n√∫mero de chamada e aguarde ser chamado no balc√£o.
            </div>

            <button class="print-button" onclick="window.print()">
                üñ®Ô∏è Imprimir Recibo
            </button>
        </div>
    </div>

    <script>
      // Inlined navbar component
      class CustomNavbar extends HTMLElement {
        connectedCallback() {
          this.attachShadow({ mode: 'open' });
          this.shadowRoot.innerHTML = `
            <style>
              nav {
                background-color: #111;
                color: white;
                padding: 1rem 2rem;
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                z-index: 1000;
                box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
              }

              .nav-container {
                max-width: 1200px;
                margin: 0 auto;
                display: flex;
                justify-content: space-between;
                align-items: center;
              }

              .logo {
                font-size: 1.5rem;
                font-weight: bold;
                display: flex;
                align-items: center;
                gap: 0.5rem;
              }
              .logo-icon {
                color: #ff6b00;
              }
              .cart-icon {
                position: relative;
                cursor: pointer;
              }

              .cart-count {
                position: absolute;
                top: -8px;
                right: -8px;
                background-color: #f97316;
                color: white;
                border-radius: 50%;
                width: 20px;
                height: 20px;
                display: flex;
                justify-content: center;
                align-items: center;
                font-size: 12px;
              }
            </style>
            <nav>
              <div class="nav-container">
                <div class="logo">
                  <i data-feather="coffee" class="logo-icon"></i>
                  <span>Sistema de Gest√£o - Senhor Le√£o</span>
                </div>
                <div class="cart-icon">
                  <i data-feather="shopping-cart"></i>
                  <span class="cart-count" id="nav-cart-count">0</span>
                </div>
              </div>
            </nav>
          `;

          document.addEventListener('cartUpdated', (e) => {
            const count = e.detail.count;
            this.shadowRoot.getElementById('nav-cart-count').textContent = count;
          });
        }
      }
      customElements.define('custom-navbar', CustomNavbar);
      // Inlined footer component
      class CustomFooter extends HTMLElement {
        connectedCallback() {
          this.attachShadow({ mode: 'open' });
          this.shadowRoot.innerHTML = `
            <style>
              footer {
                background-color: #111;
                color: white;
                padding: 2rem;
                margin-top: 4rem;
              }

              .footer-container {
                max-width: 1200px;
                margin: 0 auto;
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                gap: 2rem;
              }

              .footer-section h3 {
                font-size: 1.2rem;
                margin-bottom: 1rem;
                color: #f97316;
              }

              .footer-section ul {
                list-style: none;
                padding: 0;
                margin: 0;
              }

              .footer-section li {
                margin-bottom: 0.5rem;
              }

              .footer-section a {
                color: #ccc;
                text-decoration: none;
                transition: color 0.2s;
              }

              .footer-section a:hover {
                color: white;
              }

              .social-icons {
                display: flex;
                gap: 1rem;
              }

              .social-icons a {
                display: inline-flex;
                align-items: center;
                justify-content: center;
                width: 36px;
                height: 36px;
                background-color: #333;
                border-radius: 50%;
                color: white;
                transition: background-color 0.2s;
              }

              .social-icons a:hover {
                background-color: #f97316;
              }

              .copyright {
                text-align: center;
                margin-top: 3rem;
                padding-top: 1rem;
                border-top: 1px solid #333;
                color: #999;
                font-size: 0.9rem;
              }
            </style>
            <footer>
              <div class="footer-container">
                <div class="footer-section">
                  <h3>Sistema de Gest√£o - Senhor Le√£o</h3>
                  <p>Servindo os melhores pratos da cidade desde 2024. Ingredientes de qualidade, sabor incr√≠vel.</p>
                </div>
                <div class="footer-section">
                  <h3>Links R√°pidos</h3>
                  <ul>
                    <li><a href="#">In√≠cio</a></li>
                    <li><a href="#">Card√°pio</a></li>
                    <li><a href="#">Sobre N√≥s</a></li>
                    <li><a href="#">Contato</a></li>
                  </ul>
                </div>
                <div class="footer-section">
                  <h3>Contato</h3>
                  <ul>
                    <li>Rua dos Sabores, 123</li>
                    <li>Sua Cidade, SC 12345</li>
                    <li>Telefone: (47) 98765-4321</li>
                    <li>Email: contato@senhorleao.com</li>
                  </ul>
                </div>
                <div class="footer-section">
                  <h3>Siga-nos</h3>
                  <div class="social-icons">
                    <a href="#"><i data-feather="facebook"></i></a>
                    <a href="#"><i data-feather="instagram"></i></a>
                    <a href="#"><i data-feather="twitter"></i></a>
                  </div>
                </div>
              </div>
              <div class="copyright">
                &copy; 2024 Sistema de Gest√£o - Senhor Le√£o. Todos os direitos reservados.
              </div>
            </footer>
          `;
        }
      }
      customElements.define('custom-footer', CustomFooter);

        // Global variables
        let availableProducts = [];
        let cart = [];
        // Use absolute URLs to avoid routing conflicts with static files
        const API_BASE = window.location.protocol + '//' + window.location.host + '/products';
        const RECIBOS_API = window.location.protocol + '//' + window.location.host + '/recibos';

      // Product details database
      const productDetails = {
            // Lanches
            1: { // X-Burger
                description: "Hamb√∫rguer artesanal de 180g com molho especial da casa, alface crocante, tomate maduro, cebola roxa e picles.",
                ingredients: ["P√£o brioche", "Hamb√∫rguer 180g", "Queijo cheddar", "Alface", "Tomate", "Cebola", "Picles", "Molho especial"],
                nutrition: { calories: 650, protein: 35, carbs: 45, fat: 32 },
                preparation: "Grelhado na chapa, montado fresco"
            },
            2: { // X-Salada
                description: "Vers√£o leve do cl√°ssico hamb√∫rguer, com vegetais frescos e molho light.",
                ingredients: ["P√£o integral", "Hamb√∫rguer 150g", "Alface", "Tomate", "Cebola", "Pepino", "Molho light"],
                nutrition: { calories: 480, protein: 28, carbs: 38, fat: 18 },
                preparation: "Grelhado na chapa, op√ß√£o saud√°vel"
            },
            3: { // X-Bacon
                description: "Delicioso hamb√∫rguer com tiras crocantes de bacon defumado e queijo derretido.",
                ingredients: ["P√£o brioche", "Hamb√∫rguer 180g", "Queijo cheddar", "Bacon crocante", "Alface", "Tomate", "Molho barbecue"],
                nutrition: { calories: 780, protein: 42, carbs: 48, fat: 45 },
                preparation: "Grelhado com bacon crocante"
            },
            4: { // Frango Grelhado
                description: "Peito de frango grelhado temperado com ervas finas, leve e saud√°vel.",
                ingredients: ["Peito de frango 200g", "P√£o brioche", "Alface", "Tomate", "Molho de iogurte", "Ervas finas"],
                nutrition: { calories: 420, protein: 38, carbs: 35, fat: 12 },
                preparation: "Grelhado lentamente, suculento"
            },
            5: { // Sandu√≠che Natural
                description: "Sandu√≠che saud√°vel com peito de peru, queijo branco e vegetais frescos.",
                ingredients: ["P√£o integral", "Peito de peru", "Queijo branco", "Alface", "Tomate", "Cenoura", "Molho de mostarda"],
                nutrition: { calories: 380, protein: 32, carbs: 42, fat: 8 },
                preparation: "Montado fresco, op√ß√£o saud√°vel"
            },

            // Especiais R√°pidos
            6: { // Cachorro-Quente Tradicional
                description: "Cachorro-quente completo com todos os acompanhamentos tradicionais.",
                ingredients: ["P√£o de hot dog", "Salsicha especial", "Pur√™ de batatas", "Batata palha", "Milho verde", "Ervilha", "Molhos variados"],
                nutrition: { calories: 580, protein: 18, carbs: 65, fat: 28 },
                preparation: "Salsicha grelhada, acompanhamentos frescos"
            },
            7: { // Cachorro-Quente Duplo
                description: "Por√ß√£o dupla do nosso cachorro-quente tradicional.",
                ingredients: ["2 p√£es de hot dog", "2 salsichas especiais", "Pur√™ de batatas", "Batata palha", "Milho verde", "Ervilha", "Molhos variados"],
                nutrition: { calories: 920, protein: 32, carbs: 110, fat: 48 },
                preparation: "Duas salsichas grelhadas, por√ß√£o generosa"
            },

            // Por√ß√µes
            8: { // Batata Frita Pequena
                description: "Por√ß√£o pequena de batatas fritas crocantes com sal marinho.",
                ingredients: ["Batatas selecionadas", "√ìleo vegetal", "Sal marinho"],
                nutrition: { calories: 320, protein: 4, carbs: 42, fat: 16 },
                preparation: "Fritas duas vezes para m√°xima croc√¢ncia"
            },
            9: { // Batata Frita M√©dia
                description: "Por√ß√£o m√©dia de batatas fritas crocantes com sal marinho.",
                ingredients: ["Batatas selecionadas", "√ìleo vegetal", "Sal marinho"],
                nutrition: { calories: 480, protein: 6, carbs: 64, fat: 24 },
                preparation: "Fritas duas vezes para m√°xima croc√¢ncia"
            },
            10: { // Batata Frita Grande
                description: "Por√ß√£o grande de batatas fritas crocantes com sal marinho.",
                ingredients: ["Batatas selecionadas", "√ìleo vegetal", "Sal marinho"],
                nutrition: { calories: 640, protein: 8, carbs: 86, fat: 32 },
                preparation: "Fritas duas vezes para m√°xima croc√¢ncia"
            },
            11: { // Batata com Cheddar e Bacon
                description: "Batatas fritas cobertas com queijo cheddar derretido e bacon crocante.",
                ingredients: ["Batatas fritas", "Queijo cheddar", "Bacon crocante", "Creme de leite"],
                nutrition: { calories: 780, protein: 24, carbs: 45, fat: 52 },
                preparation: "Batatas fritas, cobertas com queijo e bacon"
            },
            12: { // Onion Rings
                description: "An√©is de cebola empanados e fritos, crocantes por fora e macios por dentro.",
                ingredients: ["Cebola fresca", "Farinha de trigo", "Ovos", "√ìleo vegetal", "Temperos"],
                nutrition: { calories: 380, protein: 8, carbs: 42, fat: 22 },
                preparation: "Empanados e fritos at√© dourar"
            },
            13: { // Frango Empanado Crocante
                description: "Tiras de frango empanadas e fritas, servidas com molho especial.",
                ingredients: ["Peito de frango", "Farinha de trigo", "Ovos", "Farinha de rosca", "Temperos", "√ìleo vegetal"],
                nutrition: { calories: 520, protein: 35, carbs: 38, fat: 28 },
                preparation: "Empanado e frito at√© ficar crocante"
            },

            // Pratos Feitos
            14: { // PF de Frango
                description: "Prato feito completo com frango grelhado, acompanhamentos e salada fresca.",
                ingredients: ["Frango grelhado", "Arroz branco", "Feij√£o carioca", "Salada de alface e tomate", "Farofa de mandioca"],
                nutrition: { calories: 620, protein: 42, carbs: 78, fat: 18 },
                preparation: "Frango grelhado, acompanhamentos caseiros"
            },
            15: { // PF de Bife Acebolado
                description: "Prato feito com bife acebolado suculento e acompanhamentos tradicionais.",
                ingredients: ["Bife de contra-fil√©", "Cebola", "Arroz branco", "Feij√£o carioca", "Salada mista", "Farofa"],
                nutrition: { calories: 680, protein: 45, carbs: 72, fat: 24 },
                preparation: "Bife acebolado, acompanhamentos frescos"
            },
            16: { // PF de Carne Mo√≠da
                description: "Carne mo√≠da refogada com temperos especiais, acompanhamentos completos.",
                ingredients: ["Carne mo√≠da", "Cebola", "Tomate", "Arroz branco", "Feij√£o carioca", "Salada"],
                nutrition: { calories: 580, protein: 38, carbs: 68, fat: 20 },
                preparation: "Carne refogada lentamente, acompanhamentos"
            },
            17: { // PF de Omelete
                description: "Omelete recheado com queijo e presunto, acompanhamentos completos.",
                ingredients: ["Ovos", "Queijo", "Presunto", "Arroz branco", "Feij√£o carioca", "Salada"],
                nutrition: { calories: 520, protein: 32, carbs: 55, fat: 22 },
                preparation: "Omelete recheado, acompanhamentos frescos"
            },

            // Pratos Especiais
            18: { // Parmegiana de Frango
                description: "Frango empanado com molho de tomate, queijo gratinado, arroz e batata frita.",
                ingredients: ["Peito de frango", "Molho de tomate", "Queijo mussarela", "Arroz branco", "Batata frita"],
                nutrition: { calories: 850, protein: 48, carbs: 72, fat: 38 },
                preparation: "Empanado, gratinado, acompanhamentos"
            },
            19: { // Parmegiana de Carne
                description: "Carne empanada com molho de tomate, queijo gratinado, arroz e batata frita.",
                ingredients: ["Carne bovina", "Molho de tomate", "Queijo mussarela", "Arroz branco", "Batata frita"],
                nutrition: { calories: 920, protein: 52, carbs: 68, fat: 45 },
                preparation: "Empanado, gratinado, acompanhamentos"
            },
            20: { // Macarronada
                description: "Macarr√£o ao molho especial, escolha entre molho ao sugo ou bolonhesa.",
                ingredients: ["Macarr√£o", "Molho de tomate", "Carne mo√≠da", "Queijo parmes√£o", "Manjeric√£o"],
                nutrition: { calories: 680, protein: 28, carbs: 85, fat: 22 },
                preparation: "Molho caseiro, macarr√£o al dente"
            },
            21: { // Estrogonofe de Frango
                description: "Frango ao molho cremoso com champignon, arroz branco e batata palha.",
                ingredients: ["Frango", "Creme de leite", "Champignon", "Arroz branco", "Batata palha"],
                nutrition: { calories: 720, protein: 42, carbs: 65, fat: 32 },
                preparation: "Molho cremoso, acompanhamentos tradicionais"
            },
            22: { // Estrogonofe de Carne
                description: "Carne ao molho cremoso com champignon, arroz branco e batata palha.",
                ingredients: ["Carne bovina", "Creme de leite", "Champignon", "Arroz branco", "Batata palha"],
                nutrition: { calories: 780, protein: 45, carbs: 62, fat: 38 },
                preparation: "Molho cremoso, acompanhamentos tradicionais"
            },

            // Saladas
            23: { // Salada Completa
                description: "Salada completa com alface, tomate, cenoura, frango desfiado e molho da casa.",
                ingredients: ["Alface", "Tomate", "Cenoura", "Frango desfiado", "Molho da casa", "Azeite"],
                nutrition: { calories: 320, protein: 28, carbs: 18, fat: 16 },
                preparation: "Ingredientes frescos, montada na hora"
            },
            24: { // Salada Caesar
                description: "Salada Caesar com frango, queijo parmes√£o, croutons e molho cremoso.",
                ingredients: ["Alface romana", "Frango grelhado", "Queijo parmes√£o", "Croutons", "Molho caesar"],
                nutrition: { calories: 380, protein: 32, carbs: 15, fat: 22 },
                preparation: "Alface fresca, molho artesanal"
            },

            // Salgados
            25: { // Coxinha de Frango
                description: "Coxinha recheada com frango e catupiry, empanada e frita.",
                ingredients: ["Massa de mandioca", "Frango desfiado", "Catupiry", "Farinha de trigo", "Ovos"],
                nutrition: { calories: 180, protein: 8, carbs: 22, fat: 8 },
                preparation: "Recheada e empanada artesanalmente"
            },
            26: { // Risoles de Presunto e Queijo
                description: "Risoles recheados com presunto e queijo, empanados e fritos.",
                ingredients: ["Massa folhada", "Presunto", "Queijo", "Ovos", "Farinha de rosca"],
                nutrition: { calories: 160, protein: 7, carbs: 18, fat: 7 },
                preparation: "Recheados e empanados"
            },
            27: { // Risoles de Carne
                description: "Risoles recheados com carne mo√≠da temperada.",
                ingredients: ["Massa folhada", "Carne mo√≠da", "Cebola", "Ovos", "Temperos"],
                nutrition: { calories: 170, protein: 9, carbs: 16, fat: 8 },
                preparation: "Carne temperada, empanados"
            },
            28: { // Enroladinho de Salsicha
                description: "Massa folhada recheada com salsicha, assada at√© dourar.",
                ingredients: ["Massa folhada", "Salsicha", "Mostarda", "Ovos"],
                nutrition: { calories: 140, protein: 6, carbs: 12, fat: 8 },
                preparation: "Assados at√© ficarem dourados"
            },
            29: { // Empada de Frango
                description: "Empada recheada com frango temperado, massa crocante.",
                ingredients: ["Massa de empada", "Frango", "Cebola", "Milho", "Azeitona"],
                nutrition: { calories: 220, protein: 10, carbs: 24, fat: 10 },
                preparation: "Recheio caseiro, massa crocante"
            },
            30: { // Empada de Palmito
                description: "Empada recheada com palmito, op√ß√£o vegetariana.",
                ingredients: ["Massa de empada", "Palmito", "Cebola", "Milho", "Azeitona"],
                nutrition: { calories: 200, protein: 6, carbs: 26, fat: 9 },
                preparation: "Op√ß√£o vegetariana, recheio fresco"
            },
            31: { // Empada de Camar√£o
                description: "Empada recheada com camar√£o, especialidade da casa.",
                ingredients: ["Massa de empada", "Camar√£o", "Cebola", "Milho", "Azeitona", "Creme de leite"],
                nutrition: { calories: 240, protein: 12, carbs: 22, fat: 12 },
                preparation: "Camar√£o fresco, recheio especial"
            },
            32: { // Quibe Frito
                description: "Quibe frito com carne mo√≠da e temperos especiais.",
                ingredients: ["Trigo para quibe", "Carne mo√≠da", "Cebola", "Hortel√£", "√ìleo vegetal"],
                nutrition: { calories: 190, protein: 8, carbs: 18, fat: 10 },
                preparation: "Fritos at√© ficarem crocantes"
            },
            33: { // Pastel Assado
                description: "Pastel assado com recheio variado, op√ß√£o mais saud√°vel.",
                ingredients: ["Massa de pastel", "Recheio variado", "Ovos"],
                nutrition: { calories: 160, protein: 6, carbs: 20, fat: 6 },
                preparation: "Assados, op√ß√£o mais saud√°vel"
            },
            34: { // Pastel Frito de Carne
                description: "Pastel frito recheado com carne mo√≠da.",
                ingredients: ["Massa de pastel", "Carne mo√≠da", "Cebola", "Ovos"],
                nutrition: { calories: 180, protein: 8, carbs: 18, fat: 8 },
                preparation: "Fritos, recheio suculento"
            },
            35: { // Pastel Frito de Queijo
                description: "Pastel frito recheado com queijo derretido.",
                ingredients: ["Massa de pastel", "Queijo", "Ovos"],
                nutrition: { calories: 170, protein: 7, carbs: 16, fat: 9 },
                preparation: "Queijo derretido, crocante"
            },
            36: { // Pastel Frito de Pizza
                description: "Pastel frito com recheio de pizza.",
                ingredients: ["Massa de pastel", "Molho de tomate", "Queijo", "Oregano"],
                nutrition: { calories: 175, protein: 7, carbs: 17, fat: 8 },
                preparation: "Sabor de pizza, frito"
            },
            37: { // Pastel Frito de Frango
                description: "Pastel frito recheado com frango desfiado.",
                ingredients: ["Massa de pastel", "Frango", "Cebola", "Ovos"],
                nutrition: { calories: 185, protein: 9, carbs: 19, fat: 7 },
                preparation: "Frango suculento, crocante"
            },

            // Bebidas
            38: { // Refrigerante Lata
                description: "Refrigerante em lata de 350ml, gelado e refrescante.",
                ingredients: ["Refrigerante", "Gelo"],
                nutrition: { calories: 140, protein: 0, carbs: 38, fat: 0 },
                preparation: "Servido gelado"
            },
            39: { // Refrigerante 600ml
                description: "Refrigerante em garrafa de 600ml, por√ß√£o perfeita para compartilhar.",
                ingredients: ["Refrigerante", "Gelo"],
                nutrition: { calories: 240, protein: 0, carbs: 65, fat: 0 },
                preparation: "Servido gelado"
            },
            40: { // Suco Natural
                description: "Suco natural feito na hora com frutas frescas da esta√ß√£o.",
                ingredients: ["Frutas frescas", "√Ågua", "A√ß√∫car (opcional)"],
                nutrition: { calories: 120, protein: 2, carbs: 28, fat: 1 },
                preparation: "Feito na hora, frutas frescas"
            },
            41: { // √Ågua
                description: "√Ågua mineral sem g√°s, fresca e pura.",
                ingredients: ["√Ågua mineral"],
                nutrition: { calories: 0, protein: 0, carbs: 0, fat: 0 },
                preparation: "Servida fresca"
            },
            42: { // Ch√° Gelado
                description: "Ch√° gelado refrescante, preparado artesanalmente.",
                ingredients: ["Ch√°", "A√ß√∫car", "Lim√£o", "Gelo"],
                nutrition: { calories: 80, protein: 0, carbs: 20, fat: 0 },
                preparation: "Preparado artesanalmente"
            }
        };

      // Initialize the app when DOM is loaded
      document.addEventListener('DOMContentLoaded', () => {
        console.log('üöÄ DOM carregado, inicializando app...');
        try {
          feather.replace();
          init();
        } catch (error) {
          console.error('‚ùå Erro na inicializa√ß√£o:', error);
        }
      });

      function init() {
          console.log('üîß Inicializando componentes...');
          try {
            renderProducts();
            renderCategories();
            renderCart();
            setupEventListeners();
            setupSearch();
            loadProducts(); // Load products from API
            console.log('‚úÖ Inicializa√ß√£o completa');
          } catch (error) {
            console.error('‚ùå Erro no init:', error);
          }
      }

        function setupEventListeners() {
            document.getElementById('checkout-btn').addEventListener('click', showOrderConfirmation);
            document.getElementById('preferentialButton').addEventListener('click', requestPreferentialService);
        }

        // Load products from API
        async function loadProducts() {
            console.log('üîÑ Iniciando carregamento de produtos da API:', API_BASE);
            try {
                const response = await fetch(API_BASE);
                console.log('üì° Resposta da API:', response.status, response.ok);

                if (!response.ok) {
                    throw new Error(`Erro HTTP: ${response.status}`);
                }

                availableProducts = await response.json();
                console.log('‚úÖ Produtos carregados:', availableProducts.length, 'itens');
                console.log('üìã Produtos:', availableProducts);

                renderProducts();
            } catch (error) {
                console.error('‚ùå Erro ao carregar produtos:', error);
                document.getElementById('productsGrid').innerHTML =
                    '<div style="text-align: center; color: #e74c3c; padding: 20px;">Erro ao carregar produtos: ' + error.message + '</div>';
            }
        }

      function renderProducts(filteredProducts = availableProducts) {
          console.log('üé® Renderizando produtos:', filteredProducts.length, 'itens');
          const productsGrid = document.getElementById('products-grid');

          if (!productsGrid) {
              console.error('‚ùå Elemento products-grid n√£o encontrado!');
              return;
          }

          productsGrid.innerHTML = '';

          if (filteredProducts.length === 0) {
              console.log('üì≠ Nenhum produto para renderizar');
              productsGrid.innerHTML = '<div class="text-center py-8 text-gray-500">Nenhum produto encontrado.</div>';
                return;
            }

          filteredProducts.forEach(product => {
              console.log('üçî Renderizando produto:', product.id, product.name, product.priceInCents);
              const details = productDetails[product.id] || {
                  description: "Produto delicioso da nossa lanchonete.",
                  ingredients: ["Ingredientes selecionados"],
                  nutrition: { calories: 0, protein: 0, carbs: 0, fat: 0 },
                  preparation: "Preparado com cuidado"
              };

              const productCard = document.createElement('div');
              productCard.className = 'product-card bg-white rounded-xl p-3 shadow-md border-2 border-transparent hover:border-orange-100 transition-all cursor-pointer';
              productCard.innerHTML = `
                  <img src="${product.image || 'https://via.placeholder.com/200x150/FF6B00/FFFFFF?text=' + encodeURIComponent(product.name)}" alt="${product.name}" class="w-full h-40 object-cover rounded-lg mb-3">
                  <div class="p-1">
                      <h3 class="font-bold text-base mb-1">${product.name}</h3>
                      <p class="text-gray-500 text-sm mb-2">${details.description}</p>
                      <div class="flex justify-between items-center mb-2">
                          <span class="text-orange-600 font-bold">R$${(product.priceInCents / 100).toFixed(2).replace('.', ',')}</span>
                          <button onclick="addToCart(${product.id})" class="bg-orange-600 hover:bg-orange-700 text-white py-1 px-3 rounded-lg text-sm transition duration-200">
                              Adicionar
                          </button>
                    </div>
                      <button type="button" class="expand-button" onclick="event.stopPropagation(); toggleProductDetails(${product.id})" id="expand-${product.id}">
                          üìñ Ver Detalhes
                      </button>

                      <div class="product-details" id="details-${product.id}">
                          <h4 class="font-bold text-sm mb-2 text-gray-800">üìã Descri√ß√£o</h4>
                          <p class="text-gray-600 text-sm mb-3">${details.description}</p>

                          <h4 class="font-bold text-sm mb-2 text-gray-800">ü•ò Ingredientes</h4>
                          <p class="text-gray-600 text-sm mb-3">${details.ingredients.join(", ")}</p>

                          <h4 class="font-bold text-sm mb-2 text-gray-800">‚è≤Ô∏è Preparo</h4>
                          <p class="text-gray-600 text-sm mb-3">${details.preparation}</p>

                          <div class="nutrition-info bg-white p-3 rounded border">
                              <h4 class="font-bold text-sm mb-2 text-gray-800">üìä Informa√ß√µes Nutricionais</h4>
                              <div class="grid grid-cols-2 gap-2 text-xs">
                                  <div><strong>Calorias:</strong> ${details.nutrition.calories}kcal</div>
                                  <div><strong>Prote√≠na:</strong> ${details.nutrition.protein}g</div>
                                  <div><strong>Carboidratos:</strong> ${details.nutrition.carbs}g</div>
                                  <div><strong>Gordura:</strong> ${details.nutrition.fat}g</div>
                </div>
                          </div>
                      </div>
                  </div>
              `;
              productsGrid.appendChild(productCard);
          });
      }

      function renderCategories() {
          const categoriesContainer = document.querySelector('.categories');
          // Como os produtos n√£o t√™m categoria definida na API, vamos criar uma categoria padr√£o
          const uniqueCategories = ['Lanches', 'Bebidas', 'Por√ß√µes'];
          categoriesContainer.innerHTML = '';
          uniqueCategories.forEach(category => {
              const chip = document.createElement('button');
              chip.className = 'chip px-4 py-2 rounded-full bg-orange-50 text-orange-600 font-medium text-sm';
              chip.textContent = category;
              chip.onclick = () => filterByCategory(category);
              categoriesContainer.appendChild(chip);
          });
          const allChip = document.createElement('button');
          allChip.className = 'chip px-4 py-2 rounded-full bg-orange-600 text-white font-medium text-sm';
          allChip.textContent = 'Todos';
          allChip.onclick = () => renderProducts();
          categoriesContainer.prepend(allChip);
      }

      function filterByCategory(category) {
          // Como os produtos n√£o t√™m categoria definida, vamos mostrar todos por enquanto
          // Futuramente podemos adicionar categorias aos produtos na API
          renderProducts(availableProducts);
      }

      function setupSearch() {
          const searchInput = document.getElementById('searchInput');
          searchInput.addEventListener('input', (e) => {
              const term = e.target.value.toLowerCase();
              const filtered = availableProducts.filter(p =>
                  p.name.toLowerCase().includes(term)
              );
              renderProducts(filtered);
          });
        }

        // Product selection functions
        function selectProduct(productId) {
            const product = availableProducts.find(p => p.id === productId);
            if (!product) return;

            const quantity = getProductQuantity(productId);
            if (quantity > 0) {
                addToCart(product, quantity);
                resetProductQuantity(productId);
                updateProductCard(productId, false);
            }
        }

        function increaseQuantity(productId) {
            const qtyElement = document.getElementById(`qty-${productId}`);
            const currentQty = parseInt(qtyElement.textContent);
            qtyElement.textContent = currentQty + 1;
            updateProductCard(productId, true);
        }

        function decreaseQuantity(productId) {
            const qtyElement = document.getElementById(`qty-${productId}`);
            const currentQty = parseInt(qtyElement.textContent);
            if (currentQty > 0) {
                qtyElement.textContent = currentQty - 1;
                updateProductCard(productId, currentQty > 1);
            }
        }

        function getProductQuantity(productId) {
            const qtyElement = document.getElementById(`qty-${productId}`);
            return parseInt(qtyElement.textContent);
        }

        function resetProductQuantity(productId) {
            document.getElementById(`qty-${productId}`).textContent = '0';
        }

        function updateProductCard(productId, isSelected) {
            const card = document.querySelector(`[data-id="${productId}"]`);
            if (isSelected) {
                card.classList.add('selected');
            } else {
                card.classList.remove('selected');
            }
        }

        function addToCart(productId) {
            const product = availableProducts.find(p => p.id === productId);
            if (!product) return;
            const existingItem = cart.find(item => item.productId === productId);
            if (existingItem) {
                existingItem.quantity += 1;
            } else {
                cart.push({
                    productId: product.id,
                    name: product.name,
                    price: product.priceInCents,
                    quantity: 1
                });
            }
            renderCart();
            showNotification(`${product.name} adicionado ao carrinho!`);
        }

        function renderCart() {
            const cartItems = document.getElementById('cart-items');
            const emptyCartMessage = document.getElementById('empty-cart-message');
            const checkoutBtn = document.getElementById('checkout-btn');
            cartItems.innerHTML = '';
            if (cart.length === 0) {
                emptyCartMessage.classList.remove('hidden');
                checkoutBtn.disabled = true;
            } else {
                emptyCartMessage.classList.add('hidden');
                checkoutBtn.disabled = false;
                cart.forEach(item => {
                    const cartItem = document.createElement('div');
                    cartItem.className = 'cart-item mb-3 pb-3 border-b border-gray-200';
                    cartItem.innerHTML = `
                        <div class="flex justify-between items-start">
                            <div>
                                <h4 class="font-medium">${item.name}</h4>
                                <div class="flex items-center mt-1">
                                    <button onclick="updateQuantity(${item.productId}, ${item.quantity - 1})" class="text-gray-500 hover:text-gray-700 text-sm">
                                        <i data-feather="minus" class="w-4 h-4"></i>
                                    </button>
                                    <span class="mx-2">${item.quantity}</span>
                                    <button onclick="updateQuantity(${item.productId}, ${item.quantity + 1})" class="text-gray-500 hover:text-gray-700 text-sm">
                                        <i data-feather="plus" class="w-4 h-4"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="text-right">
                                <span class="block font-medium">R$${((item.price * item.quantity) / 100).toFixed(2).replace('.', ',')}</span>
                                <button onclick="removeFromCart(${item.productId})" class="text-red-500 hover:text-red-700 text-sm mt-1">
                                    Remover
                                </button>
                            </div>
                        </div>
                    `;
                    cartItems.appendChild(cartItem);
                });
            }
            updateTotals();
            feather.replace();
            // Dispatch event for navbar cart count
            document.dispatchEvent(new CustomEvent('cartUpdated', {
                detail: { count: cart.reduce((sum, item) => sum + item.quantity, 0) }
            }));
        }

        function removeFromCart(index) {
            cart.splice(index, 1);
            renderCart();
            updateOrderButton();
        }

        function updateCartTotal() {
            const total = cart.reduce((sum, item) => sum + (item.quantity * item.price), 0);
            document.getElementById('totalAmount').textContent = (total / 100).toFixed(2);
        }

        function updateOrderButton() {
            const button = document.getElementById('orderButton');
            button.disabled = cart.length === 0;
        }

        function showOrderConfirmation() {
            if (cart.length === 0) {
                alert('Adicione pelo menos um produto ao seu pedido!');
                return;
            }

            const orderModal = document.getElementById('order-modal');
            const orderSummary = document.getElementById('order-summary');
            let summaryHTML = '<div class="mb-4">';
            cart.forEach(item => {
                summaryHTML += `
                    <div class="flex justify-between mb-1">
                        <span>${item.name} x ${item.quantity}</span>
                        <span>R$${((item.price * item.quantity) / 100).toFixed(2).replace('.', ',')}</span>
                    </div>
                `;
            });
            const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            const tax = subtotal * 0.1;
            const total = subtotal + tax;
            summaryHTML += `</div>
                <div class="border-t border-gray-200 pt-2">
                    <div class="flex justify-between mb-1">
                        <span>Subtotal:</span>
                        <span>R$${(subtotal / 100).toFixed(2).replace('.', ',')}</span>
                    </div>
                    <div class="flex justify-between mb-1">
                        <span>Taxa (10%):</span>
                        <span>R$${(tax / 100).toFixed(2).replace('.', ',')}</span>
                    </div>
                    <div class="flex justify-between font-bold mt-2">
                        <span>Total:</span>
                        <span>R$${(total / 100).toFixed(2).replace('.', ',')}</span>
                    </div>
                </div>
            `;
            orderSummary.innerHTML = summaryHTML;
            orderModal.classList.remove('hidden');
        }

        function closeModal() {
            document.getElementById('order-modal').classList.add('hidden');
        }

        async function processOrder() {
            const checkoutBtn = document.getElementById('checkout-btn');
            const originalText = checkoutBtn.textContent;
            checkoutBtn.disabled = true;
            checkoutBtn.textContent = '‚è≥ Processando...';

            try {
                // Prepare order data
                const itens = cart.map(item => ({
                    nome: item.name,
                    quantidade: item.quantity,
                    preco: item.price
                }));

                const orderData = {
                    itens: itens,
                    observacoes: "Pedido realizado via sistema web",
                    formaPagamento: "Dinheiro"
                };

                // Send order to API
                const response = await fetch(`${RECIBOS_API}/pagar`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(orderData)
                });

                if (!response.ok) {
                    throw new Error(`Erro na API: ${response.status}`);
                }

                const receipt = await response.json();

                // Show receipt modal
                showReceiptModal(receipt);

                // Clear cart and close order modal
                cart = [];
                renderCart();
                closeModal();

            } catch (error) {
                console.error('Erro ao fazer pedido:', error);
                alert('Erro ao processar o pedido. Tente novamente.');
            } finally {
                checkoutBtn.disabled = false;
                checkoutBtn.textContent = originalText;
            }
        }

        // Receipt modal functions
        function showReceiptModal(receipt) {
            document.getElementById('receiptNumber').textContent = `#${receipt.numeroChamada}`;

            const detailsContainer = document.getElementById('receiptDetails');
            let detailsHtml = '<div style="margin-bottom: 15px;">';

            // Order date
            if (receipt.dataCriacao) {
                const date = new Date(receipt.dataCriacao);
                detailsHtml += `<div><strong>Data:</strong> ${date.toLocaleString('pt-BR')}</div>`;
            }

            detailsHtml += '</div>';

            // Items
            detailsHtml += '<div><strong>Itens:</strong></div>';
            receipt.itens.forEach(item => {
                const subtotal = (item.quantidade * item.preco) / 100;
                detailsHtml += `
                    <div class="receipt-item">
                        <span>${item.nome} √ó ${item.quantidade}</span>
                        <span>R$ ${subtotal.toFixed(2)}</span>
                    </div>
                `;
            });

            // Total
            const total = receipt.total / 100;
            detailsHtml += `
                <div class="receipt-total">
                    <span>Total: R$ ${total.toFixed(2)}</span>
                </div>
            `;

            // Payment method
            if (receipt.formaPagamento) {
                detailsHtml += `<div style="margin-top: 10px;"><strong>Pagamento:</strong> ${receipt.formaPagamento}</div>`;
            }

            // Notes
            if (receipt.observacoes) {
                detailsHtml += `<div style="margin-top: 10px;"><strong>Observa√ß√µes:</strong> ${receipt.observacoes}</div>`;
            }

            detailsContainer.innerHTML = detailsHtml;

            // Show modal
            document.getElementById('receiptModal').style.display = 'block';
        }

        function closeReceiptModal() {
            document.getElementById('receiptModal').style.display = 'none';
        }

        // Product details expansion
        function toggleProductDetails(productId) {
            const detailsDiv = document.getElementById(`details-${productId}`);
            const expandBtn = document.getElementById(`expand-${productId}`);

            if (detailsDiv.classList.contains('show')) {
                detailsDiv.classList.remove('show');
                expandBtn.textContent = 'üìñ Ver Detalhes';
                expandBtn.classList.remove('expanded');
            } else {
                detailsDiv.classList.add('show');
                expandBtn.textContent = 'üîΩ Ocultar Detalhes';
                expandBtn.classList.add('expanded');
            }
        }

        // Preferential service - envia notifica√ß√£o direta para funcion√°rio
        async function requestPreferentialService() {
            const button = document.getElementById('preferentialButton');
            const originalText = button.textContent;
            button.disabled = true;
            button.textContent = '‚è≥ Solicitando...';

            try {
                // Envia notifica√ß√£o simples sem pedir observa√ß√µes
                const response = await fetch('/products/notificacao-preferencial', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                });

                if (!response.ok) {
                    throw new Error(`Erro na API: ${response.status}`);
                }

                const result = await response.json();

                if (result.success) {
                    alert('‚úÖ Solicita√ß√£o de atendimento preferencial enviada com sucesso!\n\nAguarde ser chamado pelo sistema de som.');
                    button.textContent = '‚úÖ Solicitado!';
                    button.disabled = true; // Desabilita ap√≥s sucesso
                } else {
                    throw new Error(result.message || 'Erro desconhecido');
                }

            } catch (error) {
                console.error('Erro ao solicitar atendimento preferencial:', error);
                alert('‚ùå Erro ao solicitar atendimento preferencial: ' + error.message);
                button.disabled = false;
                button.textContent = originalText;
            }
        }

        // Show preferential service receipt modal
        function showPreferentialReceiptModal(receipt) {
            // Create preferential modal
            const modalHtml = `
                <div id="preferentialModal" class="receipt-modal">
                    <div class="receipt-content">
                        <span class="close-button" onclick="closePreferentialModal()">&times;</span>

                        <div class="receipt-header">
                            <h2>‚≠ê ATENDIMENTO PREFERENCIAL</h2>
                            <p>Solicita√ß√£o Recebida com Prioridade!</p>
                        </div>

                        <div class="receipt-number" id="preferentialReceiptNumber">
                            #${receipt.numeroChamada}
                        </div>

                        <div class="receipt-details" id="preferentialReceiptDetails">
                            <div style="margin-bottom: 15px;">
                                <div><strong>Data:</strong> ${new Date(receipt.dataCriacao).toLocaleString('pt-BR')}</div>
                                <div><strong>Tipo:</strong> <span style="color: #e67e22; font-weight: bold;">ATENDIMENTO PREFERENCIAL</span></div>
                            </div>

                            <div><strong>Motivo:</strong></div>
                            <div style="background: #fff3cd; padding: 10px; border-radius: 6px; margin: 10px 0; border: 1px solid #f0c674;">
                                ${receipt.observacoes}
                            </div>

                            <div style="margin: 20px 0; padding: 15px; background: #fff3cd; border-radius: 8px; border: 1px solid #f0c674;">
                                <strong>‚ö° ATEN√á√ÉO:</strong><br>
                                Seu atendimento ter√° prioridade. Anote seu n√∫mero de chamada e aguarde ser chamado(a) pelo sistema de som.
                            </div>

                            <div style="margin: 20px 0; padding: 15px; background: #d4edda; border-radius: 8px; border: 1px solid #c3e6cb;">
                                <strong>üì¢ Instru√ß√µes:</strong><br>
                                ‚Ä¢ Fique atento ao sistema de som<br>
                                ‚Ä¢ Seu n√∫mero ser√° chamado em breve<br>
                                ‚Ä¢ Dirija-se ao balc√£o quando chamado
                            </div>
                        </div>

                        <button class="print-button" onclick="window.print()">
                            üñ®Ô∏è Imprimir Comprovante
                        </button>
                    </div>
                </div>
            `;

            document.body.insertAdjacentHTML('beforeend', modalHtml);
            document.getElementById('preferentialModal').style.display = 'block';
        }

        function closePreferentialModal() {
            const modal = document.getElementById('preferentialModal');
            if (modal) {
                modal.remove();
            }
        }

        // Setup preferential service button
        document.getElementById('preferentialButton').addEventListener('click', requestPreferentialService);

        // Close modal when clicking outside
        window.onclick = function(event) {
            const receiptModal = document.getElementById('receiptModal');
            const preferentialModal = document.getElementById('preferentialModal');

            if (event.target === receiptModal) {
                closeReceiptModal();
            }
            if (preferentialModal && event.target === preferentialModal) {
                closePreferentialModal();
            }
        }
    </script>
</body>
</html>
